{% extends 'main/base.html' %}

{% block content %}

<div class="d-flex col-md-12 text-center ">

<main class=" col-md-12 ">
    <h1 align="center">Протоколы</h1>
    <div id="pcap_len" style="height:350px; width:50%; float:left;"></div>
    <div id="proto" style="height:350px; width:50%; float:left;"></div>
     <h3 align="center">Таблица с сырыми данными</h3>
    <table id="ex"  class="table table-striped"  style="width:100%">
        <thead>
            <tr>
                <th>src IP</th>
                <th>Протокол</th>
                 <th>Размер</th>
                <th>Инфо</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th>src IP</th>
                <th>Протокол</th>
                 <th>Размер</th>
                <th>Инфо</th>
            </tr>
        </tfoot>
    </table>
    </main>

</div>

{% block scripts %}
  <script>
    $(document).ready(function () {
      $('#ex').DataTable({        ajax: '/http_data',
 striped: true,
    pageList: [10, 25, 50, 100, 'ALL'],
        columns: [
            {data: 'source_ip'},
            {data: 'protocol'},
            {data: 'packet_length'},
            {data: 'info'}
        ],
      });
    });
  </script>


<script src="/static/js/echarts.min.js" type="text/javascript"></script>

    <script type="text/javascript">

 // Initialize the echarts instance based on the prepared dom
      var myChart = echarts.init(document.getElementById('pcap_len'));

      // Specify the configuration items and data for the chart
      var option = {
        xAxis: {
           type : 'category',
             data: [{% for key in data.keys %}
                        "{{key}}",
                        {% endfor %}]
        },
        yAxis: {},
        series: [
          {
            type: 'bar',
             itemStyle:{
            normal:{
                label:{show:true},
                color:'#87cefa'
                },
            emphasis:{label:{show:true}}
                },
            data: [{% for key in data.values %}
                        {{key}},
                        {% endfor %}]
          }
        ]
      };
      myChart.setOption(option);
    </script>


<script type="text/javascript">
            var myChart = echarts.init(document.getElementById('proto'));
            var option = {
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                calculable : false,
                series : [
                    {
                        name:'Протокол',
                        type:'pie',
                        radius : '60%',
                        center: ['50%', '55%'],
                        data:[
                        {% for key, value in data.items %}
                        {value: {{value}} , name:'{{key}}' },
                        {% endfor %}
                        ]
                    }
                ]
            };
            myChart.setOption(option);

    </script>

{% endblock %}


{% endblock %}